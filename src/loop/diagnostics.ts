import { payments, PaymentPlan } from '../payments'; import { log } from '../store/logs'; export async function runDiagnostics(){ try{ const plan:PaymentPlan={ mandate:{ issuerDID:'did:example:mlr', subjectDID:'did:example:qa', scope:'TIP', maxAmountMinor:100000, currency:'USDC', expiresAt: Date.now()+3600000 } as any, intent:{ amountMinor:123, currency:'USDC', memo:'diag run', counterparty:'cb:mlr', rail:'X402' } as any }; const r=await payments.execute(plan); log('info','diagnostics: success '+JSON.stringify({rail:r.rail,status:r.status})); return r }catch(e:any){ log('error','diagnostics: fail '+(e?.message||String(e))); throw e } }